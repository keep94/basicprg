10 KEY OFF
11 SCREEN 0,0,0
12 WIDTH 40
15 COLOR 7,0
20 CLS
25 DIM A$(112)
30 OPEN "FILES.DIR" FOR INPUT AS #1
40 INPUT #1,A
50 FOR B=1 TO A
60 LINE INPUT #1,A$(B)
70 NEXT B
80 CLOSE #1
100 '   SUB SETUP
105 LET A$(A+1)="EXIT"
107 LET A=A+1
110 FOR B=1 TO A
120 LET X1=B-24*INT((B-1)/24)
130 LET Y1=13*INT((B-1)/24) + 1
140 LOCATE X1,Y1:PRINT A$(B)
150 NEXT B
160 LOCATE 1,1:COLOR 0,7:PRINT A$(1)
170 LET B=1
200 '   SUB INPUT
210 LET X$=""
215 WHILE LEN(X$)<1:LET X$=INKEY$:WEND
220 IF X$=CHR$(0)+"H" THEN GOSUB 500
230 IF X$=CHR$(0)+"K" THEN GOSUB 600
240 IF X$=CHR$(0)+"M" THEN GOSUB 700
250 IF X$=CHR$(0)+"P" THEN GOSUB 800
260 IF X$=CHR$(13) THEN 280
270 GOSUB 900
280 IF A$(B)="EXIT" THEN COLOR 7,0:CLS:END
290 COLOR 7,0:RUN A$(B)
500 '   SUB UP
510 IF B=1 THEN RETURN 210
520 LET C=B
530 LET B=B-1
540 GOSUB 1500
550 GOSUB 1600
560 RETURN 210
600 '   SUB LEFT
610 IF B-24<1 THEN RETURN 210
620 LET C=B
630 LET B=B-24
640 GOSUB 1500
650 GOSUB 1600
660 RETURN 210
700 '   SUB RIGHT
710 IF B+24>A THEN RETURN 210
720 LET C=B
730 LET B=B+24
740 GOSUB 1500
750 GOSUB 1600
760 RETURN 210
800 '   SUB DOWN
810 IF B+1>A THEN RETURN 210
820 LET C=B
830 LET B=B+1
840 GOSUB 1500
850 GOSUB 1600
860 RETURN 210
900 '   SUB SEARCH
910 LET C=B
920 FOR B=1 TO A
930 IF X$<A$(B) THEN 960
940 NEXT B
950 LET B=B-1
960 GOSUB 1500
970 GOSUB 1600
980 RETURN 210
1500 '   SUB DISAPPEAR
1510 LET X1=C-24*INT((C-1)/24)
1520 LET Y1=13*INT((C-1)/24) + 1
1530 LOCATE X1,Y1:COLOR 7,0:PRINT A$(C)
1540 RETURN
1600 '   SUB APPEAR
1610 LET X1=B-24*INT((B-1)/24)
1620 LET Y1=13*INT((B-1)/24) + 1
1630 LOCATE X1,Y1:COLOR 0,7:PRINT A$(B)
1640 RETURN
